{% extends "base.html" %}
{% block content %}

<h3 class="center-align">My Nest</h3>
<a href="{{ url_for('view_messages') }}" class=" btn"> <i class="fa-solid fa-envelope"></i> </a>
<div class="row">
    <div class="col s12 m5">
        <div class="card-panel">
            <div class= card-heading>
                <h4 > My life list </h4>
                <a href="{{ url_for('show_life_list') }}"><i class="fa-solid fa-binoculars"></i></a>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col s12 m5">
        <div class="card-panel">
            <div class=card-heading>
                <h4> My Bird Stats </h4>
            </div>
            <div class="bird-stats">
                <div>
                    Total Birds Observed:
                </div>
                <div>
                    Total Bird Species Observed:
                </div>
                <div>
                    Average Confidence:
                </div>
                <div>
                    Highest Number of Observations in a Week:
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col s12 m5">
        <div class="card-panel">
            <div class=card-heading>
                <h4> Contact Admin </h4>
            </div>
            <div class="contact-form-container">
                <form method="POST" action="{{ url_for('new_message') }}">
                    <div class="row">
                        <div class="input-field col s12 hidden">
                            <input id="sender" name="sender" type="text" value=" {{ session.user }} " pattern="^[a-zA-Z\s]{2,}$">
                            <label for="sender">Sender</label>
                        </div>
                    </div>                    
                    <div class="row">
                        <div class="input-field col s12 hidden">
                            <input id="recipient" name="recipient" type="text" value="admin" pattern="^[a-zA-Z\s]{2,}$">
                            <label for="recipient">Recipient</label>
                        </div>
                    </div>                    
                    <div class="row">
                        <div class="input-field col s12">
                            <input id="subject" name="subject" type="text" pattern="^[a-zA-Z\s]{2,}$" required>
                            <label for="subject">Subject</label>
                        </div>
                    </div>
                    <div class="row">
                        <div class="input-field col s12">
                            <textarea id="body" name="body" class="materialize-textarea"></textarea>
                            <label for="body">Type your message</label>
                        </div>                    
                    </div>
                    <div class="row">
                        <button type="submit" class="col s12 btn-large">
                            Submit Observation <i class="fas fa-circle-plus"></i>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>


<div class="row">
    <div class="col s12">
        <div class="card-panel">
            <table class="highlight">
                <h4>My Observations</h4>
                <a class="btn-small" href="{{ url_for('add_observation') }}">New Observation <i class="fa-solid fa-crow"></i><i
                        class="fa-solid fa-plus"></i></a>
                <thead>
                    <tr>
                        <th>Bird Species</th>
                        <th>Location</th>
                        <th>Date</th>
                        <th>Time</th>
                    </tr>
                </thead>

                <tbody>
                    {% for observation in observations %}
                    {% if session.user|lower == observation.seen_by|lower %}
                    <tr>
                        <td>{{ observation.bird_species }}</td>
                        <td>{{ observation.location }}</td>
                        <td>{{ observation.date }}</td>
                        <td>{{ observation.time }}</td>
                        <td>
                            <a href="{{ url_for('edit_observation', observation_id=observation._id) }}" class="btn-small">
                                <i class="fa-solid fa-pencil"></i>
                            </a>
                        </td>
                        <td>
                            <a href="#confirm-delete" class="btn modal-trigger red">
                                <i class="fa-regular fa-trash-can "></i>
                            </a>
                            <div id="confirm-delete" class="modal">
                                <div class="modal-content">
                                    <h4>Delete Observation</h4>
                                    <p>
                                        Are you sure you want to delete this observation? <br>
                                        Observation selected for deletion: <br>
                                        {{ observation.bird_species }}, {{ observation.location }}, {{ observation.date }}
                                    </p>
                                </div>
                                <div class="modal-footer">
                                    <a href="{{ url_for('delete_observation', observation_id=observation._id) }}"
                                        class="modal-close btn-flat">Agree</a>
                                    <a href="{{ url_for('my_nest') }}" class="modal-close btn-flat">Cancel</a>
                                </div>
                            </div>
                        </td>
                    </tr>
                    {% endif %}
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>

     
{% endblock %}